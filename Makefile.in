OS_REVISION := $(shell uname -r)
OS := $(shell uname -s)
ISA_TARGET := $(shell isainfo -k)
OS_ARCH := $(OS)_$(OS_REVISION)_$(ISA_TARGET)
OBJ_BASE := obj
OBJ_DIR := $(OBJ_BASE)/$(OS_ARCH)
prefix = @prefix@

SRC = check_samfs.c
BIN = $(OBJ_DIR)/check_samfs

CFLAGS = @samfs_inc@
LDFLAGS = -L/opt/SUNWsamfs/lib -lfsmgmt -lcsn -L /usr/lib/fs/samfs -l samconf -z ignore \
 -R/opt/SUNWsamfs/lib -R/usr/lib/fs/samfs 
BIN = check_samfs
prefix = @prefix@

all: $(BIN)

$(BIN): src/$(SRC)
	$(CC) $(CFLAGS) $(LDFLAGS) src/$(SRC) -o $(BIN)

install:
	ginstall -d $(DESTDIR)/$(prefix)/nagios/libexec
	ginstall -m 755 $(BIN) $(DESTDIR)/$(prefix)/nagios/libexec

clean:
	rm -f $(BIN)

distclean: clean
	rm -rf autom4te.cache
	rm -f *.log
	rm -f config.status
